!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.qviz=e():t.qviz=e()}(self,(()=>(()=>{"use strict";var t={812:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ConditionalRender=void 0,function(t){t[t.Always=0]="Always",t[t.OnZero=1]="OnZero",t[t.OnOne=2]="OnOne",t[t.AsGroup=3]="AsGroup"}(e.ConditionalRender||(e.ConditionalRender={}))},242:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.regLineStart=e.argsFontSize=e.labelFontSize=e.controlBtnRadius=e.controlBtnOffset=e.nestedGroupPadding=e.groupBoxPadding=e.classicalRegHeight=e.registerHeight=e.labelPadding=e.gatePadding=e.gateHeight=e.minGateWidth=e.startY=e.startX=e.leftPadding=e.svgNS=void 0,e.svgNS="http://www.w3.org/2000/svg",e.leftPadding=20,e.startX=80,e.startY=40,e.minGateWidth=40,e.gateHeight=40,e.gatePadding=10,e.labelPadding=10,e.registerHeight=e.gateHeight+2*e.gatePadding,e.classicalRegHeight=e.gateHeight,e.groupBoxPadding=e.gatePadding,e.nestedGroupPadding=2,e.controlBtnOffset=40,e.controlBtnRadius=15,e.labelFontSize=14,e.argsFontSize=12,e.regLineStart=40},993:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.dashedBox=e.dashedLine=e.arc=e.text=e.box=e.controlDot=e.circle=e.line=e.group=e.createSvgElement=void 0;var r=n(242);e.createSvgElement=function(t,e){void 0===e&&(e={});var n=document.createElementNS(r.svgNS,t);return Object.entries(e).forEach((function(t){var e=t[0],r=t[1];return n.setAttribute(e,r)})),n};e.group=function(t,n){void 0===n&&(n={});var r=(0,e.createSvgElement)("g",n);return t.forEach((function(t){return r.appendChild(t)})),r};e.line=function(t,n,r,a,i){var o={x1:t.toString(),x2:r.toString(),y1:n.toString(),y2:a.toString()};return null!=i&&(o.class=i),(0,e.createSvgElement)("line",o)};e.circle=function(t,n,r,a){var i={cx:t.toString(),cy:n.toString(),r:r.toString()};return null!=a&&(i.class=a),(0,e.createSvgElement)("circle",i)};e.controlDot=function(t,n,r){return void 0===r&&(r=5),(0,e.circle)(t,n,r,"control-dot")};e.box=function(t,n,r,a,i){return void 0===i&&(i="gate-unitary"),(0,e.createSvgElement)("rect",{class:i,x:t.toString(),y:n.toString(),width:r.toString(),height:a.toString()})};e.text=function(t,n,a,i){void 0===i&&(i=r.labelFontSize);var o=(0,e.createSvgElement)("text",{"font-size":i.toString(),x:n.toString(),y:a.toString()});return o.textContent=t,o};e.arc=function(t,n,r,a){return(0,e.createSvgElement)("path",{class:"arc-measure",d:"M ".concat(t+2*r," ").concat(n," A ").concat(r," ").concat(a," 0 0 0 ").concat(t," ").concat(n)})};e.dashedLine=function(t,n,r,a,i){var o=(0,e.line)(t,n,r,a,i);return o.setAttribute("stroke-dasharray","8, 8"),o};e.dashedBox=function(t,n,r,a,i){var o=(0,e.box)(t,n,r,a,i);return o.setAttribute("fill-opacity","0"),o.setAttribute("stroke-dasharray","8, 8"),o}},805:function(t,e,n){var r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,a=0,i=e.length;a<i;a++)!r&&a in e||(r||(r=Array.prototype.slice.call(e,0,a)),r[a]=e[a]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e._classicalControlled=e._groupedOperations=e._controlledGate=e._swap=e._unitary=e._measure=e._zoomButton=e._createGate=e._formatGate=e.formatGates=void 0;var a=n(316),i=n(242),o=n(993),l=function(t,e){void 0===e&&(e=0);var n=t.map((function(t){return c(t,e)}));return(0,o.group)(n)};e.formatGates=l;var c=function(t,e){void 0===e&&(e=0);var n=t.type,r=t.x,i=t.controlsY,o=t.targetsY,l=t.label,c=t.displayArgs,u=t.width;switch(n){case a.GateType.Measure:return s([p(r,i[0])],t,e);case a.GateType.Unitary:return s([f(l,r,o,u,c)],t,e);case a.GateType.X:return s([v(t,e)],t,e);case a.GateType.Swap:return i.length>0?x(t,e):s([h(t,e)],t,e);case a.GateType.Cnot:case a.GateType.ControlledUnitary:return x(t,e);case a.GateType.Group:return m(t,e);case a.GateType.ClassicalControlled:return w(t);default:throw new Error("ERROR: unknown gate (".concat(l,") of type ").concat(n,"."))}};e._formatGate=c;var s=function(t,e,n){var r=(e||{}).dataAttributes,a={class:"gate"};Object.entries(r||{}).forEach((function(t){var e=t[0],n=t[1];return a["data-".concat(e)]=n}));var i=u(e,n);return null!=i&&(t=t.concat([i])),(0,o.group)(t,a)};e._createGate=s;var u=function(t,e){if(null==t)return null;var n=d(t,e),r=n[0],a=n[1],i=t.dataAttributes,l="expanded"in(i=i||{}),c=r+2,s=a+2,u=(0,o.circle)(c,s,10);if(l){var p=[u,(0,o.createSvgElement)("path",{d:"M".concat(c-7,",").concat(s," h14")})];return(0,o.group)(p,{class:"gate-control gate-collapse"})}if("true"==i["zoom-in"]){p=[u,(0,o.createSvgElement)("path",{d:"M".concat(c,",").concat(s-7," v14 M").concat(c-7,",").concat(s," h14")})];return(0,o.group)(p,{class:"gate-control gate-expand"})}return null};e._zoomButton=u;var d=function(t,e){var n=t.x,r=t.width,o=t.type,l=t.targetsY,c=(null==l?void 0:l.flatMap((function(t){return t})))||[],s=Math.max.apply(Math,c),u=Math.min.apply(Math,c);if(o===a.GateType.Group){var d=i.groupBoxPadding-e*i.nestedGroupPadding;return[n-2*d,u-i.gateHeight/2-d,r+2*d,s+ +i.gateHeight/2+d-(u-i.gateHeight/2-d)]}return[n-r/2,u-i.gateHeight/2,n+r,s+i.gateHeight/2]},p=function(t,e){t-=i.minGateWidth/2;var n=i.minGateWidth,r=i.gateHeight,a=(0,o.box)(t,e-r/2,n,r,"gate-measure"),l=(0,o.arc)(t+5,e+2,n/2-5,r/2-8),c=(0,o.line)(t+n/2,e+8,t+n-8,e-r/2+8);return(0,o.group)([a,l,c])};e._measure=p;var f=function(t,e,n,a,l,c){if(void 0===c&&(c=!0),0===n.length)throw new Error("Failed to render unitary gate (".concat(t,"): has no y-values"));var s=n.map((function(n){var r=n[n.length-1],o=n[0],c=r-o+i.gateHeight;return g(t,e,o,a,c,l)}));if(c&&s.length>1){var u=n[n.length-1],d=n[0],p=u[u.length-1],f=d[0],h=(0,o.dashedLine)(e,f,e,p);return(0,o.group)(r([h],s,!0))}return(0,o.group)(s)};e._unitary=f;var g=function(t,e,n,r,a,l){void 0===a&&(a=i.gateHeight);var c=(n-=i.gateHeight/2)+a/2-(null==l?0:7),s=[(0,o.box)(e-r/2,n,r,a),(0,o.text)(t,e,c)];if(null!=l){var u=n+a/2+8,d=(0,o.text)(l,e,u,i.argsFontSize);s.push(d)}return(0,o.group)(s)},h=function(t,e){var n=t.x,a=t.targetsY,i=d(t,e),l=i[0],c=i[1],s=i[2],u=i[3],p=(null==a?void 0:a.flatMap((function(t){return t})))||[],f=(0,o.box)(l,c,s,u,"gate-swap"),g=p.map((function(t){return y(n,t)})),h=(0,o.line)(n,p[0],n,p[1]);return(0,o.group)(r(r([f],g,!0),[h],!1))};e._swap=h;var v=function(t,e){var n=t.x,r=t.targetsY.flatMap((function(t){return t}));return b(n,r[0])},y=function(t,e){var n=(0,o.line)(t-8,e-8,t+8,e+8),r=(0,o.line)(t-8,e+8,t+8,e-8);return(0,o.group)([n,r])},x=function(t,e){var n=[],i=t.type,l=t.x,c=t.controlsY,u=t.label,d=t.displayArgs,p=t.width,g=t.targetsY;switch(i){case a.GateType.Cnot:g.forEach((function(t){return n.push(b(l,t))}));break;case a.GateType.Swap:g.forEach((function(t){return n.push(y(l,t))}));break;case a.GateType.ControlledUnitary:var h=g;n.push(f(u,l,h,p,d,!1)),g=g.flat();break;default:throw new Error("ERROR: Unrecognized gate: ".concat(u," of type ").concat(i))}var v=c.map((function(t){return(0,o.controlDot)(l,t)})),x=Math.max.apply(Math,r(r([],c,!1),g,!1)),m=Math.min.apply(Math,r(r([],c,!1),g,!1)),w=(0,o.line)(l,m,l,x);return s(r(r([w],v,!0),n,!0),t,e)};e._controlledGate=x;var b=function(t,e,n){void 0===n&&(n=15);var r=(0,o.circle)(t,e,n),a=(0,o.line)(t,e-n,t,e+n),i=(0,o.line)(t-n,e,t+n,e);return(0,o.group)([r,a,i],{class:"oplus"})},m=function(t,e){var n=t.children,r=d(t,e),a=r[0],i=r[1],c=r[2],u=r[3],p=[(0,o.dashedBox)(a,i,c,u)];return null!=n&&p.push(l(n,e+1)),s(p,t,e)};e._groupedOperations=m;var w=function(t,e){void 0===e&&(e=i.groupBoxPadding);var n=t.controlsY,r=t.dataAttributes,a=t.targetsY,c=t.children,s=t.x,u=t.width,d=n[0],p=[];if(null!=c){if(2!==c.length)throw new Error("Invalid number of children found for classically-controlled gate: ".concat(c.length));var f=l(c[0]);f.setAttribute("class","gates-zero"),p.push(f);var g=l(c[1]);g.setAttribute("class","gates-one"),p.push(g)}var h=s+i.controlBtnRadius,v=S(h,d),y=d+i.controlBtnRadius,x=d+i.classicalRegHeight/2,b=(0,o.dashedLine)(h,y,h,x,"classical-line");s+=i.controlBtnOffset;var m=(0,o.dashedLine)(h,x,s,x,"classical-line");u=u-i.controlBtnOffset+2*(e-i.groupBoxPadding),s+=i.groupBoxPadding-e;var w=a[0]-i.gateHeight/2-e,F=a[1]-a[0]+i.gateHeight+2*e,O=(0,o.dashedBox)(s,w,u,F,"classical-container");p.push.apply(p,[m,b,v,O]);var A={class:"classically-controlled-group classically-controlled-unknown"};return null!=r&&Object.entries(r).forEach((function(t){var e=t[0],n=t[1];return A["data-".concat(e)]=n})),(0,o.group)(p,A)};e._classicalControlled=w;var S=function(t,e,n){return void 0===n&&(n=i.controlBtnRadius),(0,o.group)([(0,o.circle)(t,e,n),(0,o.text)("?",t,e,i.labelFontSize)],{class:"classically-controlled-btn"})}},892:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e._qubitInput=e.formatInputs=void 0;var r=n(557),a=n(242),i=n(993);e.formatInputs=function(t){var e=[],n={},l=a.startY;return t.forEach((function(t){var i=t.id,c=t.numChildren;e.push(o(l)),n[i]={type:r.RegisterType.Qubit,y:l},null!=c&&0!==c?(l+=a.classicalRegHeight,n[i].children=Array.from(Array(c),(function(){var t={type:r.RegisterType.Classical,y:l};return l+=a.classicalRegHeight,t}))):l+=a.registerHeight})),{qubitWires:(0,i.group)(e),registers:n,svgHeight:l}};var o=function(t){var e=(0,i.text)("|0âŸ©",a.leftPadding,t,16);return e.setAttribute("text-anchor","start"),e.setAttribute("dominant-baseline","middle"),e};e._qubitInput=o},670:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e._qubitRegister=e._classicalRegister=e.formatRegisters=void 0;var r=n(242),a=n(316),i=n(993);e.formatRegisters=function(t,e,n){var r=[];for(var c in t)r.push(l(Number(c),n,t[c].y));return e.forEach((function(t){var e=t.type,i=t.x,l=t.targetsY,c=t.controlsY;if(e===a.GateType.Measure){var s=c[0];l.forEach((function(t){r.push(o(i,s,n,t))}))}})),(0,i.group)(r)};var o=function(t,e,n,r){var a=(0,i.line)(t+1,e,t+1,r-1,"register-classical"),o=(0,i.line)(t-1,e,t-1,r+1,"register-classical"),l=(0,i.line)(t+1,r-1,n,r-1,"register-classical"),c=(0,i.line)(t-1,r+1,n,r+1,"register-classical");return(0,i.group)([a,o,l,c])};e._classicalRegister=o;var l=function(t,e,n,a){void 0===a&&(a=16);var o=(0,i.line)(r.regLineStart,n,e,n),l=(0,i.text)("q".concat(t),r.regLineStart,n-a);return l.setAttribute("dominant-baseline","hanging"),l.setAttribute("text-anchor","start"),l.setAttribute("font-size","75%"),(0,i.group)([o,l])};e._qubitRegister=l},316:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GateType=void 0,function(t){t[t.Measure=0]="Measure",t[t.Cnot=1]="Cnot",t[t.Swap=2]="Swap",t[t.X=3]="X",t[t.Unitary=4]="Unitary",t[t.ControlledUnitary=5]="ControlledUnitary",t[t.ClassicalControlled=6]="ClassicalControlled",t[t.Group=7]="Group",t[t.Invalid=8]="Invalid"}(e.GateType||(e.GateType={}))},323:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},r.apply(this,arguments)},a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,a=0,i=e.length;a<i;a++)!r&&a in e||(r||(r=Array.prototype.slice.call(e,0,a)),r[a]=e[a]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e._offsetChildrenX=e._fillMetadataX=e._splitTargetsY=e._getRegY=e._opToMetadata=e._getClassicalRegStart=e._alignOps=e._groupOperations=e.processOperations=void 0;var i=n(242),o=n(812),l=n(316),c=n(557),s=n(679),u=function(t,e){if(0===t.length)return{metadataList:[],svgWidth:i.startX};var n=d(t,e),r=p(n),o=Math.max.apply(Math,a([0],r.map((function(t){return t.length})),!1)),c=new Array(o).fill(i.minGateWidth),s=f(t,r),u={},h=r.map((function(n){return n.map((function(n,r){var a=null;null==n||u.hasOwnProperty(n)||(a=t[n],u[n]=!0);var i=g(a,e);if(null!=a&&[l.GateType.Unitary,l.GateType.ControlledUnitary].includes(i.type)){var o=s.filter((function(t){var e=t[0];t[1];return e<=r})).map((function(t){t[0];var n=t[1];if(null==n.cId)throw new Error("Could not find cId for classical register.");var r=e[n.qId].children;if(null==r)throw new Error("Failed to find classical registers for qubit ID ".concat(n.qId,"."));return r[n.cId].y}));i.targetsY=v(a.targets,o,e)}return i.width>c[r]&&(c[r]=i.width),i}))})),x=y(h,c);return{metadataList:h.flat().filter((function(t){return t.type!=l.GateType.Invalid})),svgWidth:x}};e.processOperations=u;var d=function(t,e){var n=Math.max.apply(Math,a([-1],Object.keys(e).map(Number),!1))+1,r=Array.from(Array(n),(function(){return new Array(0)}));return t.forEach((function(t,e){var i=t.targets,o=t.controls||[],l=a(a([],o,!0),i,!0).filter((function(t){return(t.type||c.RegisterType.Qubit)===c.RegisterType.Qubit})),s=l.map((function(t){return t.qId})),u=o.filter((function(t){return(t.type||c.RegisterType.Qubit)===c.RegisterType.Classical})),d=u.length>0;if(d||0!==l.length)for(var p=d?0:Math.min.apply(Math,s),f=d?n-1:Math.max.apply(Math,s),g=p;g<=f;g++)r[g].push(e)})),r};e._groupOperations=d;var p=function(t){for(var e=Math.max.apply(Math,a([0],t.map((function(t){return t.length})),!1)),n=0,r=JSON.parse(JSON.stringify(t));n<e;){for(var i=function(t){var i=r[t];if(i.length<=n)return"continue";var o=i[n],l=r.map((function(t){return t.indexOf(o)})),c=Math.max.apply(Math,a([-1],l,!1));n<c&&(r[t].splice(n,0,null),e=Math.max(e,r[t].length))},o=0;o<r.length;o++)i(o);n++}return r};e._alignOps=p;var f=function(t,e){var n=[];return e.forEach((function(e){for(var r=function(r){var a=e[r];if(null!=a&&t[a].isMeasurement){var i=t[a].targets.filter((function(t){return t.type===c.RegisterType.Classical}));i.forEach((function(t){return n.push([r,t])}))}},a=0;a<e.length;a++)r(a)})),n};e._getClassicalRegStart=f;var g=function(t,e){var n={type:l.GateType.Invalid,x:0,controlsY:[],targetsY:[],label:"",width:-1};if(null==t)return n;var a=t.gate,c=t.dataAttributes,d=t.displayArgs,p=t.isMeasurement,f=t.isConditional,g=t.isControlled,v=t.isAdjoint,y=t.controls,x=t.targets,b=t.children,m=t.conditionalRender;if(n.controlsY=(null==y?void 0:y.map((function(t){return h(t,e)})))||[],n.targetsY=x.map((function(t){return h(t,e)})),f){if(null==b||0==b.length)throw new Error("No children operations found for classically-controlled operation.");var w=b.filter((function(t){return t.conditionalRender!==o.ConditionalRender.OnOne})),S=(C=u(w,e)).metadataList,F=C.svgWidth,O=b.filter((function(t){return t.conditionalRender!==o.ConditionalRender.OnZero})),A=(C=u(O,e)).metadataList,E=C.svgWidth,R=Math.max(F,E)-i.startX-2*i.gatePadding;n.type=l.GateType.ClassicalControlled,n.children=[S,A],n.width=R+i.controlBtnOffset+2*i.groupBoxPadding;var _=Object.values(e).map((function(t){return t.y}));_.length>0&&(n.targetsY=[Math.min.apply(Math,_),Math.max.apply(Math,_)])}else if(m==o.ConditionalRender.AsGroup&&((null==b?void 0:b.length)||0)>0){var C=u(b,e);n.type=l.GateType.Group,n.children=C.metadataList,n.dataAttributes={expanded:"true"},n.width=C.svgWidth-i.startX+2*(i.groupBoxPadding-i.gatePadding)}else p?n.type=l.GateType.Measure:"SWAP"===a?n.type=l.GateType.Swap:g?(n.type="X"===a?l.GateType.Cnot:l.GateType.ControlledUnitary,n.label=a):"X"===a?(n.type=l.GateType.X,n.label=a):(n.type=l.GateType.Unitary,n.label=a);return v&&n.label.length>0&&(n.label+="'"),null!=d&&(n.displayArgs=d),n.width=(0,s.getGateWidth)(n),null!=c&&(n.dataAttributes=r(r({},n.dataAttributes),c)),n};e._opToMetadata=g;var h=function(t,e){var n=t.type,r=t.qId,a=t.cId;if(!e.hasOwnProperty(r))throw new Error("ERROR: Qubit register with ID ".concat(r," not found."));var i=e[r],o=i.y,l=i.children;switch(n){case void 0:case c.RegisterType.Qubit:return o;case c.RegisterType.Classical:if(null==l)throw new Error("ERROR: No classical registers found for qubit ID ".concat(r,"."));if(null==a)throw new Error("ERROR: No ID defined for classical register associated with qubit ID ".concat(r,"."));if(l.length<=a)throw new Error("ERROR: Classical register ID ".concat(a," invalid for qubit ID ").concat(r," with ").concat(l.length," classical register(s)."));return l[a].y;default:throw new Error("ERROR: Unknown register type ".concat(n,"."))}};e._getRegY=h;var v=function(t,e,n){if(0===t.length)return[];var r=Object.keys(n).map(Number);r.sort((function(t,e){return n[t].y-n[e].y}));var a={};r.forEach((function(t,e){return a[t]=e})),(t=t.slice()).sort((function(t,e){var n=a[t.qId]-a[e.qId];return 0===n&&null!=t.cId&&null!=e.cId?t.cId-e.cId:n})),(e=e.slice()).sort((function(t,e){return t-e}));var i=0,o=0;return t.reduce((function(t,r){var l=h(r,n),c=a[r.qId];for(0===t.length||c>i+1||e[0]>o&&e[0]<l?t.push([l]):t[t.length-1].push(l),i=c,o=l;e.length>0&&e[0]<=l;)e.shift();return t}),[])};e._splitTargetsY=v;var y=function(t,e){var n=i.startX,r=e.map((function(t){var e=n;return n+=t+2*i.gatePadding,e})),a=n;return t.forEach((function(t){return t.forEach((function(t,n){var a=r[n];switch(t.type){case l.GateType.ClassicalControlled:case l.GateType.Group:var o=a-i.startX+i.groupBoxPadding;t.type===l.GateType.ClassicalControlled&&(o+=i.controlBtnOffset),x(t.children,o),t.x=a;break;default:t.x=a+e[n]/2}}))})),a};e._fillMetadataX=y;var x=function(t,e){null!=t&&t.flat().forEach((function(t){t.x+=e,x(t.children,e)}))};e._offsetChildrenX=x},557:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RegisterType=void 0,function(t){t[t.Qubit=0]="Qubit",t[t.Classical=1]="Classical"}(e.RegisterType||(e.RegisterType={}))},201:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sqore=void 0;var r=n(892),a=n(805),i=n(670),o=n(323),l=n(812),c=n(316),s=n(67),u=n(679),d=n(242),p=function(){function t(t,e){void 0===e&&(e={}),this.style={},this.gateRegistry={},this.circuit=t,this.style=this.getStyle(e)}return t.prototype.draw=function(t,e){var n=this;if(void 0===e&&(e=0),null==t)throw new Error("Container not provided.");var r=JSON.parse(JSON.stringify(this.circuit));if(r.operations.forEach((function(t,e){return n.fillGateRegistry(t,e.toString())})),r.operations=this.selectOpsAtDepth(r.operations,e),1==r.operations.length&&null!=r.operations[0].dataAttributes&&r.operations[0].dataAttributes.hasOwnProperty("id")){var a=r.operations[0].dataAttributes.id;this.expandOperation(r.operations,a)}this.renderCircuit(t,r)},t.prototype.getStyle=function(t){if(void 0===t&&(t={}),"string"==typeof t||t instanceof String){var e=t;if(!s.STYLES.hasOwnProperty(e))return console.error("No style ".concat(e," found in STYLES.")),{};t=s.STYLES[e]}return t},t.prototype.renderCircuit=function(t,e){var n=this.compose(e),r=this.generateSvg(n);t.innerHTML="",t.appendChild(r),this.addGateClickHandlers(t,e)},t.prototype.compose=function(t){var e,n,l=function(t,e){var n;Array.isArray(e)?e.forEach((function(e){return l(t,e)})):(t.push(e),null===(n=e.children)||void 0===n||n.forEach((function(e){return l(t,e)})))},s=t.qubits,u=t.operations,d=(0,r.formatInputs)(s),p=d.qubitWires,f=d.registers,g=d.svgHeight,h=(0,o.processOperations)(u,f),v=h.metadataList,y=h.svgWidth,x=(0,a.formatGates)(v),b=(e=v,n=[],l(n,e),n).filter((function(t){return t.type===c.GateType.Measure}));return{width:y,height:g,elements:[p,(0,i.formatRegisters)(f,b,y),x]}},t.prototype.generateSvg=function(t){var e=t.width,n=t.height,r=t.elements,a=(0,u.createUUID)(),i=document.createElementNS(d.svgNS,"svg");i.setAttribute("id",a),i.setAttribute("class","qviz"),i.setAttribute("width",e.toString()),i.setAttribute("height",n.toString()),i.style.setProperty("max-width","fit-content");var o=document.createElement("style");return o.innerHTML=(0,s.style)(this.style),i.appendChild(o),r.forEach((function(t){return i.appendChild(t)})),i},t.prototype.fillGateRegistry=function(t,e){var n,r=this;null==t.dataAttributes&&(t.dataAttributes={}),t.dataAttributes.id=e,t.dataAttributes["zoom-out"]="false",this.gateRegistry[e]=t,null===(n=t.children)||void 0===n||n.forEach((function(t,n){r.fillGateRegistry(t,"".concat(e,"-").concat(n)),null==t.dataAttributes&&(t.dataAttributes={}),t.dataAttributes["zoom-out"]="true"})),t.dataAttributes["zoom-in"]=(null!=t.children).toString()},t.prototype.selectOpsAtDepth=function(t,e){var n=this;if(e<0)throw new Error("Invalid renderDepth of ".concat(e,". Needs to be >= 0."));return 0===e?t:t.map((function(t){return null!=t.children?n.selectOpsAtDepth(t.children,e-1):t})).flat()},t.prototype.addGateClickHandlers=function(t,e){this.addClassicalControlHandlers(t),this.addZoomHandlers(t,e)},t.prototype.addClassicalControlHandlers=function(t){t.querySelectorAll(".classically-controlled-btn").forEach((function(t){t.addEventListener("click",(function(e){var n,r=t.querySelector("text"),a=t.parentElement;if(null!=r&&null!=a){var i=null===(n=r.firstChild)||void 0===n?void 0:n.nodeValue,o=null==a?void 0:a.querySelector(".gates-zero"),l=null==a?void 0:a.querySelector(".gates-one");switch(i){case"?":r.childNodes[0].nodeValue="1",a.classList.remove("classically-controlled-unknown"),a.classList.remove("classically-controlled-zero"),a.classList.add("classically-controlled-one"),null==o||o.classList.add("hidden"),null==l||l.classList.remove("hidden");break;case"1":r.childNodes[0].nodeValue="0",a.classList.remove("classically-controlled-unknown"),a.classList.add("classically-controlled-zero"),a.classList.remove("classically-controlled-one"),null==o||o.classList.remove("hidden"),null==l||l.classList.add("hidden");break;case"0":r.childNodes[0].nodeValue="?",a.classList.add("classically-controlled-unknown"),a.classList.remove("classically-controlled-zero"),a.classList.remove("classically-controlled-one"),null==o||o.classList.remove("hidden"),null==l||l.classList.remove("hidden")}e.stopPropagation()}}))}))},t.prototype.addZoomHandlers=function(t,e){var n=this;t.querySelectorAll(".gate .gate-control").forEach((function(r){r.addEventListener("click",(function(a){var i,o=null===(i=r.parentElement)||void 0===i?void 0:i.getAttribute("data-id");"string"==typeof o&&(r.classList.contains("gate-collapse")?n.collapseOperation(e.operations,o):r.classList.contains("gate-expand")&&n.expandOperation(e.operations,o),n.renderCircuit(t,e),a.stopPropagation())}))}))},t.prototype.expandOperation=function(t,e){var n=this;t.forEach((function(t){if(t.conditionalRender===l.ConditionalRender.AsGroup&&n.expandOperation(t.children||[],e),null==t.dataAttributes)return t;t.dataAttributes.id===e&&null!=t.children&&(t.conditionalRender=l.ConditionalRender.AsGroup,t.dataAttributes.expanded="true")}))},t.prototype.collapseOperation=function(t,e){var n=this;t.forEach((function(t){if(t.conditionalRender===l.ConditionalRender.AsGroup&&n.collapseOperation(t.children||[],e),null==t.dataAttributes)return t;t.dataAttributes.id.startsWith(e)&&(t.conditionalRender=l.ConditionalRender.Always,delete t.dataAttributes.expanded)}))},t}();e.Sqore=p},67:function(t,e){var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.style=e.STYLES=void 0;var r={lineStroke:"#000000",lineWidth:1,textColour:"#000000",unitary:"#D9F1FA",oplus:"#FFFFFF",measure:"#FFDE86",classicalUnknown:"#E5E5E5",classicalZero:"#C40000",classicalOne:"#4059BD",classicalZeroText:"#FFFFFF",classicalOneText:"#FFFFFF"};e.STYLES={Default:r,BlackAndWhite:{lineStroke:"#000000",lineWidth:1,textColour:"#000000",unitary:"#FFFFFF",oplus:"#FFFFFF",measure:"#FFFFFF",classicalUnknown:"#FFFFFF",classicalZero:"#000000",classicalOne:"#000000",classicalZeroText:"#FFFFFF",classicalOneText:"#FFFFFF"},Inverted:{lineStroke:"#FFFFFF",lineWidth:1,textColour:"#FFFFFF",unitary:"#000000",oplus:"#000000",measure:"#000000",classicalUnknown:"#000000",classicalZero:"#FFFFFF",classicalOne:"#FFFFFF",classicalZeroText:"#000000",classicalOneText:"#000000"}};e.style=function(t){void 0===t&&(t={});var e=n(n({},r),t);return"".concat(a(e),"\n    ").concat(i(e),"\n    ").concat(o)};var a=function(t){return"\n    line,\n    circle,\n    rect {\n        stroke: ".concat(t.lineStroke,";\n        stroke-width: ").concat(t.lineWidth,";\n    }\n    text {\n        fill: ").concat(t.textColour,";\n        dominant-baseline: middle;\n        text-anchor: middle;\n        font-family: Arial;\n    }\n    .control-dot {\n        fill: ").concat(t.lineStroke,";\n    }\n    .oplus line, .oplus circle {\n        fill: ").concat(t.oplus,";\n        stroke-width: 2;\n    }\n    .gate-unitary {\n        fill: ").concat(t.unitary,";\n    }\n    .gate-measure {\n        fill: ").concat(t.measure,";\n    }\n    rect.gate-swap {\n        fill: transparent;\n        stroke: transparent;\n    }\n    .arc-measure {\n        stroke: ").concat(t.lineStroke,";\n        fill: none;\n        stroke-width: ").concat(t.lineWidth,";\n    }\n    .register-classical {\n        stroke-width: ").concat((t.lineWidth||0)/2,";\n    }")},i=function(t){var e="\n    .classically-controlled-one .classical-container,\n    .classically-controlled-one .classical-line {\n        stroke: ".concat(t.classicalOne,";\n        stroke-width: ").concat((t.lineWidth||0)+.3,";\n        fill: ").concat(t.classicalOne,";\n        fill-opacity: 0.1;\n    }\n    .classically-controlled-zero .classical-container,\n    .classically-controlled-zero .classical-line {\n        stroke: ").concat(t.classicalZero,";\n        stroke-width: ").concat((t.lineWidth||0)+.3,";\n        fill: ").concat(t.classicalZero,";\n        fill-opacity: 0.1;\n    }"),n="\n    .classically-controlled-btn {\n        cursor: pointer;\n    }\n    .classically-controlled-unknown .classically-controlled-btn {\n        fill: ".concat(t.classicalUnknown,";\n    }\n    .classically-controlled-one .classically-controlled-btn {\n        fill: ").concat(t.classicalOne,";\n    }\n    .classically-controlled-zero .classically-controlled-btn {\n        fill: ").concat(t.classicalZero,";\n    }"),r="\n    .classically-controlled-btn text {\n        dominant-baseline: middle;\n        text-anchor: middle;\n        stroke: none;\n        font-family: Arial;\n    }\n    .classically-controlled-unknown .classically-controlled-btn text {\n        fill: ".concat(t.textColour,";\n    }\n    .classically-controlled-one .classically-controlled-btn text {\n        fill: ").concat(t.classicalOneText,";\n    }\n    .classically-controlled-zero .classically-controlled-btn text {\n        fill: ").concat(t.classicalZeroText,";\n    }");return"\n    .hidden {\n        display: none;\n    }\n    .classically-controlled-unknown {\n        opacity: 0.25;\n    }\n\n    ".concat(e,"\n    ").concat(n,"\n    ").concat(r)},o="\n    .qviz .gate-collapse,\n    .qviz .gate-expand {\n        opacity: 0;\n        transition: opacity 1s;\n    }\n\n    .qviz:hover .gate-collapse,\n    .qviz:hover .gate-expand {\n        visibility: visible;\n        opacity: 0.2;\n        transition: visibility 1s;\n        transition: opacity 1s;\n    }\n\n    .gate-expand, .gate-collapse {\n        cursor: pointer;\n    }\n\n    .gate-collapse circle,\n    .gate-expand circle {\n        fill: white;\n        stroke-width: 2px;\n        stroke: black;\n    }\n    .gate-collapse path,\n    .gate-expand path {\n        stroke-width: 4px;\n        stroke: black;\n    }\n\n    .gate:hover > .gate-collapse,\n    .gate:hover > .gate-expand {\n        visibility: visible;\n        opacity: 1;\n        transition: opacity 1s;\n    }"},679:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e._getStringWidth=e.getGateWidth=e.createUUID=void 0;var r=n(316),a=n(242);e.createUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))};e.getGateWidth=function(t){var e=t.type,n=t.label,o=t.displayArgs,l=t.width;if(l>0)return l;switch(e){case r.GateType.Measure:case r.GateType.Cnot:case r.GateType.Swap:return a.minGateWidth;default:var c=i(n),s=null!=o?i(o,a.argsFontSize):0,u=Math.max(c,s)+2*a.labelPadding;return Math.max(a.minGateWidth,u)}};var i=function(t,e){void 0===e&&(e=a.labelFontSize);var n=document.createElement("canvas").getContext("2d");if(null==n)throw new Error("Null canvas");return n.font="".concat(e,"px Arial"),n.measureText(t).width};e._getStringWidth=i}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}var r={};return(()=>{var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.STYLES=t.draw=void 0;var e=n(201);t.draw=function(t,n,r,a){void 0===r&&(r={}),void 0===a&&(a=0),new e.Sqore(t,r).draw(n,a)};var a=n(67);Object.defineProperty(t,"STYLES",{enumerable:!0,get:function(){return a.STYLES}})})(),r})()));
//# sourceMappingURL=qviz.min.js.map